"use strict";var picData=[10005,20005,30005,40005,60005,80005,90005,100005,120005,130005,140005,150005,160005,170005,180005,190005,200005,210005,220005,230005,240005,250005,270005,280005,300005,310005,320005,320005];!function(){var n=null,t=null,i=!1,r=[],o=6,e=6*o,s={TABLE:$("<table cellspacing='0'></table>"),myRow:8,myColumn:o+2,init:function(n){var t="start"===n?this.picFn():this.resetPicFn();r=[],this.TABLE.html(this.trFn(t)),$("#app").html(this.TABLE)},trFn:function(n){for(var t=0,i="";t<this.myRow;t++)r[t]=[],i+="<tr>"+this.tdFn(t,n[t])+"</tr>";return i},tdFn:function(n,t){for(var i=0,o="";i<this.myColumn;i++)r[n].push(t[i]),0===n||n===this.myRow-1||0===i||i===this.myColumn-1?o+="<td></td>":null===t[i]?o+='<td><i class="pic-link pic-true"></i></td>':o+='<td id="pic_'+n+"_"+i+'"><i data-x="'+n+'"data-y="'+i+'" class="pic-link pic-'+t[i]+'" ></i></td>';return o},picFn:function(){for(var n=0,t=0,i=picData.length,r=Math.floor(6*o/9),e=Number,s=[],c=[];n<9;n++)e=Math.floor(Math.random()*i),s.push(picData[e]);for(;t<r;t++)c=c.concat(s);return c.sort(function(){return.5-Math.random()}),this.picGroupFn(c)},picGroupFn:function(n){function t(t){for(var i=0,s=n.slice((t-1)*o,t*o);i<r.myColumn;i++)0===t||t===r.myRow-1||0===i||i===r.myColumn-1?e[t].push(null):e[t].push(s[i-1])}for(var i=0,r=this,e=[];i<r.myRow;i++)e[i]=[],t(i);return e},resetPicFn:function(){console.log(r);for(var n=0,t=r.slice(1,r.length-1),i=[],o=[];n<6;n++)i=t[n].slice(1,this.myColumn-1),o=o.concat(i);return o.sort(function(){return.5-Math.random()}),this.picGroupFn(o)}};({init:function(){this.even()},startView:function(n){s.init(n),$("#fn-start").html("重新开始"),$("#fn-reset").removeClass("fn-hide"),$("#app").animate({height:$("#app table").height()})},even:function(){var n=this;$("#app").on("click",".pic-link",function(){$(".pic-link").removeClass("pic-false"),$(this).hasClass("pic-true")||n.pointFn($(this))}),$("#fn-start").on("click",function(){e=6*o,n.startView("start")}),$("#fn-reset").on("click",function(){n.startView("reset")})},pointFn:function(r){var o=parseInt(r.attr("data-x")),e=parseInt(r.attr("data-y"));if(r.addClass("fn-crt"),!i)return n={x:o,y:e},void(i=!i);i&&(t={x:o,y:e},i=!i,this.countPointFn())},countPointFn:function(){return console.log(n),console.log(t),n.x===t.x&&n.y===t.y?(console.log("the same pic"),void this.picStatusFn("error")):r[n.x][n.y]!==r[t.x][t.y]?(console.log("pic is no"),void this.picStatusFn("error")):void(this.isStep0()||this.isStep1()||this.isStep2()||(this.picStatusFn("error"),console.log(">>>> other ?")))},isStep0:function(){return!!this.compareFn(n,t)&&(this.picStatusFn("remove"),!0)},isStep1:function(){var i={x:n.x,y:t.y},o={x:t.x,y:n.y};return this.compareFn(n,i,!1)&&this.compareFn(t,i,!1)&&null===r[i.x][i.y]?(this.picStatusFn("remove"),!0):!(!this.compareFn(n,o,!1)||!this.compareFn(t,o,!1)||null!==r[o.x][o.y])&&(this.picStatusFn("remove"),!0)},isStep2:function(){var i=this,o={x:n.x,y:s.myColumn},e={x:s.myRow,y:n.y},c={x:n.x,y:0},a={x:0,y:n.y},l={};if(this.compareSecondFn(n,o,function(n){if(l={x:t.x,y:n.y},i.compareFn(n,l)&&null===r[l.x][l.y]&&i.compareFn(l,t))return console.log(">>> step1"+JSON.stringify(l)),!0},1))return i.picStatusFn("remove"),!0;if(this.compareSecondFn(n,e,function(n){if(l={x:n.x,y:t.y},i.compareFn(n,l)&&null===r[l.x][l.y]&&i.compareFn(l,t))return console.log(">>> step2"+JSON.stringify(l)),!0},1))return i.picStatusFn("remove"),!0;if(this.compareSecondFn(n,c,function(n){if(l={x:t.x,y:n.y},i.compareFn(n,l)&&null===r[l.x][l.y]&&i.compareFn(l,t))return console.log(">>> step3"+JSON.stringify(l)),!0},-1))return i.picStatusFn("remove"),!0;return!!this.compareSecondFn(n,a,function(n){if(l={x:n.x,y:t.y},i.compareFn(n,l)&&null===r[l.x][l.y]&&i.compareFn(l,t))return console.log(">>> step4"+JSON.stringify(l)),!0},-1)&&(i.picStatusFn("remove"),!0)},compareSecondFn:function(n,t,i,o){var e=0,s=0,c={};if(n.x===t.x)if(e=n.y-t.y>0?t.y:n.y,s=n.y-t.y>0?n.y:t.y,o>0){for(e++;e<s&&null===r[n.x][e];e++)if(c={x:n.x,y:e},console.log("back x | 1: "+JSON.stringify(c)),i&&i(c))return!0}else if(o<0)for(s--;s>=e&&null===r[n.x][s];s--)if(c={x:n.x,y:s},console.log("back x | -1: "+JSON.stringify(c)),i&&i(c))return!0;if(n.y===t.y)if(e=n.x-t.x>0?t.x:n.x,s=n.x-t.x>0?n.x:t.x,o>0){for(e++;e<s&&null===r[e][n.y];e++)if(c={x:e,y:n.y},console.log("back y | 1 : "+JSON.stringify(c)),i&&i(c))return!0}else if(o<0)for(s--;s>=e&&null===r[s][n.y];s--)if(c={x:s,y:n.y},console.log("back y | -1 : "+JSON.stringify(c)),i&&i(c))return!0;return!1},compareFn:function(n,t,i){var o=0,e=0,s=!0;if((i=void 0===i||i)&&(1===Math.abs(n.x-t.x)&&n.y===t.y||1===Math.abs(n.y-t.y)&&n.x===t.x))return s;if(n.x===t.x){for(o=n.y-t.y>0?t.y:n.y,e=n.y-t.y>0?n.y:t.y,o++;o<e;o++)if(null!==r[n.x][o]){s=!1;break}return s}if(n.y===t.y){for(o=n.x-t.x>0?t.x:n.x,e=n.x-t.x>0?n.x:t.x,o++;o<e;o++)if(null!==r[o][n.y]){s=!1;break}return s}return!1},picStatusFn:function(i){var o="#pic_"+n.x+"_"+n.y,e="#pic_"+t.x+"_"+t.y,s=$(o+","+e).find(".pic-link");if(s.removeClass("fn-crt"),"remove"===i)return r[n.x][n.y]=null,r[t.x][t.y]=null,s.removeClass("pic-false").addClass("pic-true"),void this.isTheEndFn();"error"===i&&s.addClass("pic-false")},isTheEndFn:function(){0===(e-=2)&&alert("恭喜通关")}}).init()}();