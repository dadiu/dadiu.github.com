"use strict";var picData=[10005,20005,30005,40005,60005,80005,90005,100005,120005,130005,140005,150005,160005,170005,180005,190005,200005,210005,220005,230005,240005,250005,270005,280005,300005,310005,320005,320005];!function(){var t=null,n=null,i=!1,r=[],o=10,e=10*o,s={TABLE:$("<table cellspacing='0'></table>"),myRow:12,myColumn:o+2,init:function(t){var n="start"===t?this.picFn():this.resetPicFn();r=[],this.TABLE.html(this.trFn(n)),$("#app").html(this.TABLE)},trFn:function(t){for(var n=0,i="";n<this.myRow;n++)r[n]=[],i+="<tr>"+this.tdFn(n,t[n])+"</tr>";return i},tdFn:function(t,n){for(var i=0,o="";i<this.myColumn;i++)r[t].push(n[i]),0===t||t===this.myRow-1||0===i||i===this.myColumn-1?o+="<td></td>":null===n[i]?o+='<td><i class="pic-link pic-true"></i></td>':o+='<td id="pic_'+t+"_"+i+'"><i data-x="'+t+'"data-y="'+i+'" class="pic-link pic-'+n[i]+'" ></i></td>';return o},picFn:function(){for(var t=0,n=0,i=picData.length,r=Math.floor(10*o/25),e=Number,s=[],c=[];t<25;t++)e=Math.floor(Math.random()*i),s.push(picData[e]);for(;n<r;n++)c=c.concat(s);return c.sort(function(){return.5-Math.random()}),this.picGroupFn(c)},picGroupFn:function(t){function n(n){for(var i=0,s=t.slice((n-1)*o,n*o);i<r.myColumn;i++)0===n||n===r.myRow-1||0===i||i===r.myColumn-1?e[n].push(null):e[n].push(s[i-1])}for(var i=0,r=this,e=[];i<r.myRow;i++)e[i]=[],n(i);return e},resetPicFn:function(){console.log(r);for(var t=0,n=r.slice(1,r.length-1),i=[],o=[];t<10;t++)i=n[t].slice(1,this.myColumn-1),o=o.concat(i);return o.sort(function(){return.5-Math.random()}),this.picGroupFn(o)}};({init:function(){this.startView("start"),this.even()},startView:function(t){s.init(t),"start"===t&&(e=10*o),$("#fn-start").html("重新开始"),$("#fn-reset").removeClass("fn-hide"),$("#app").animate({height:$("#app table").height()})},even:function(){var t=this;/iphone|ipad|android/.test(navigator.userAgent)&&alert("请在电脑上玩。"),$("#app").on("click",".pic-link",function(){$(".pic-link").removeClass("pic-false"),$(this).hasClass("pic-true")||t.pointFn($(this))}),$("#fn-start").on("click",function(){t.startView("start")}),$("#fn-reset").on("click",function(){t.startView("reset")})},pointFn:function(r){var o=parseInt(r.attr("data-x")),e=parseInt(r.attr("data-y"));if(r.addClass("fn-crt"),!i)return t={x:o,y:e},void(i=!i);i&&(n={x:o,y:e},i=!i,this.countPointFn())},countPointFn:function(){return console.log(t),console.log(n),t.x===n.x&&t.y===n.y?(console.log("the same pic"),void this.picStatusFn("error")):r[t.x][t.y]!==r[n.x][n.y]?(console.log("pic is no"),void this.picStatusFn("error")):void(this.isStep0()||this.isStep1()||this.isStep2()||(this.picStatusFn("error"),console.log(">>>> other ?")))},isStep0:function(){return!!this.compareFn(t,n)&&(this.picStatusFn("remove"),!0)},isStep1:function(){var i={x:t.x,y:n.y},o={x:n.x,y:t.y};return this.compareFn(t,i,!1)&&this.compareFn(n,i,!1)&&null===r[i.x][i.y]?(this.picStatusFn("remove"),!0):!(!this.compareFn(t,o,!1)||!this.compareFn(n,o,!1)||null!==r[o.x][o.y])&&(this.picStatusFn("remove"),!0)},isStep2:function(){var i=this,o={x:t.x,y:s.myColumn},e={x:s.myRow,y:t.y},c={x:t.x,y:0},a={x:0,y:t.y},l={};if(this.compareSecondFn(t,o,function(t){if(l={x:n.x,y:t.y},i.compareFn(t,l)&&null===r[l.x][l.y]&&i.compareFn(l,n))return console.log(">>> step1"+JSON.stringify(l)),!0},1))return i.picStatusFn("remove"),!0;if(this.compareSecondFn(t,e,function(t){if(l={x:t.x,y:n.y},i.compareFn(t,l)&&null===r[l.x][l.y]&&i.compareFn(l,n))return console.log(">>> step2"+JSON.stringify(l)),!0},1))return i.picStatusFn("remove"),!0;if(this.compareSecondFn(t,c,function(t){if(l={x:n.x,y:t.y},i.compareFn(t,l)&&null===r[l.x][l.y]&&i.compareFn(l,n))return console.log(">>> step3"+JSON.stringify(l)),!0},-1))return i.picStatusFn("remove"),!0;return!!this.compareSecondFn(t,a,function(t){if(l={x:t.x,y:n.y},i.compareFn(t,l)&&null===r[l.x][l.y]&&i.compareFn(l,n))return console.log(">>> step4"+JSON.stringify(l)),!0},-1)&&(i.picStatusFn("remove"),!0)},compareSecondFn:function(t,n,i,o){var e=0,s=0,c={};if(t.x===n.x)if(e=t.y-n.y>0?n.y:t.y,s=t.y-n.y>0?t.y:n.y,o>0){for(e++;e<s&&null===r[t.x][e];e++)if(c={x:t.x,y:e},console.log("back x | 1: "+JSON.stringify(c)),i&&i(c))return!0}else if(o<0)for(s--;s>=e&&null===r[t.x][s];s--)if(c={x:t.x,y:s},console.log("back x | -1: "+JSON.stringify(c)),i&&i(c))return!0;if(t.y===n.y)if(e=t.x-n.x>0?n.x:t.x,s=t.x-n.x>0?t.x:n.x,o>0){for(e++;e<s&&null===r[e][t.y];e++)if(c={x:e,y:t.y},console.log("back y | 1 : "+JSON.stringify(c)),i&&i(c))return!0}else if(o<0)for(s--;s>=e&&null===r[s][t.y];s--)if(c={x:s,y:t.y},console.log("back y | -1 : "+JSON.stringify(c)),i&&i(c))return!0;return!1},compareFn:function(t,n,i){var o=0,e=0,s=!0;if((i=void 0===i||i)&&(1===Math.abs(t.x-n.x)&&t.y===n.y||1===Math.abs(t.y-n.y)&&t.x===n.x))return s;if(t.x===n.x){for(o=t.y-n.y>0?n.y:t.y,e=t.y-n.y>0?t.y:n.y,o++;o<e;o++)if(null!==r[t.x][o]){s=!1;break}return s}if(t.y===n.y){for(o=t.x-n.x>0?n.x:t.x,e=t.x-n.x>0?t.x:n.x,o++;o<e;o++)if(null!==r[o][t.y]){s=!1;break}return s}return!1},picStatusFn:function(i){var o="#pic_"+t.x+"_"+t.y,e="#pic_"+n.x+"_"+n.y,s=$(o+","+e).find(".pic-link");if(s.removeClass("fn-crt"),"remove"===i)return r[t.x][t.y]=null,r[n.x][n.y]=null,s.removeClass("pic-false").addClass("pic-true"),void this.isTheEndFn();"error"===i&&s.addClass("pic-false")},isTheEndFn:function(){0===(e-=2)&&alert("恭喜通关")}}).init()}();